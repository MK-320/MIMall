# MIMallï¼ˆVue2ï¼‰é«˜ä»¿å°ç±³å•†åŸ - å‰ç«¯é¡¹ç›®ï¼ˆå« Koa Mock APIï¼‰

MIMall æ˜¯ä¸€ä¸ªä½¿ç”¨ **Vue 2.x** å¼€å‘çš„é«˜ä»¿å°ç±³å•†åŸå‰ç«¯é¡¹ç›®ï¼Œè¦†ç›–ç”µå•†ç«™ç‚¹çš„æ ¸å¿ƒé“¾è·¯ï¼š**å•†å“æµè§ˆ â†’ åŠ å…¥è´­ç‰©è½¦ â†’ ä¸‹å• â†’ è®¢å•åˆ—è¡¨/è¯¦æƒ… â†’ï¼ˆæ¨¡æ‹Ÿï¼‰æ”¯ä»˜**ï¼Œå¹¶å†…ç½®ä¸€ä¸ªå¯ç›´æ¥è¿è¡Œçš„ **Koa Mock æœåŠ¡**ï¼ˆ`koa-mock/`ï¼‰ï¼Œç”¨äºæœ¬åœ°å¼€å‘è”è°ƒã€‚

> **â€¼ï¸â‰ï¸ é‡è¦è¯´æ˜**ï¼šæœ¬ä»“åº“ä¸»è¦æ˜¯å‰ç«¯é¡¹ç›®ã€‚ç”±äºåŸå§‹åç«¯æœåŠ¡ä¸å¯ç”¨ï¼Œé¡¹ç›®å†…ç½®äº† `koa-mock/` ä½œä¸ºæœ¬åœ° Mock API æœåŠ¡ï¼Œç”¨äºæ¨¡æ‹Ÿæ¥å£ä¸ç™»å½•æ€ï¼Œ**ä¸ç­‰åŒäºçœŸå®åç«¯**ã€‚å¦‚æœä½ æœ‰å¯ç”¨çš„åç«¯æœåŠ¡ï¼Œå¯ä»¥ä¿®æ”¹ `vue.config.js` ä¸­çš„ä»£ç†é…ç½®æˆ– `src/main.js` ä¸­çš„ `axios.defaults.baseURL` æ¥æ¥å…¥çœŸå®åç«¯ã€‚

---

## ğŸ“–åŠŸèƒ½æ¦‚è§ˆ

- **ç”¨æˆ·**
  - æ³¨å†Œ / ç™»å½• / é€€å‡ºç™»å½•
  - ç™»å½•æ€æ ¡éªŒï¼ˆæœªç™»å½•ä¼šè·³è½¬åˆ°ç™»å½•é¡µï¼‰
- **å•†å“**
  - é¦–é¡µå•†å“æ¨è/å±•ç¤º
  - å•†å“è¯¦æƒ…
- **è´­ç‰©è½¦**
  - åŠ å…¥è´­ç‰©è½¦ã€æ•°é‡å¢å‡ã€åˆ é™¤
  - å…¨é€‰/å–æ¶ˆå…¨é€‰
  - è´­ç‰©è½¦æ•°é‡å¾½æ ‡ï¼ˆé¡¶éƒ¨å¯¼èˆªï¼‰
- **æ”¶è´§åœ°å€**
  - åœ°å€åˆ—è¡¨ / æ–°å¢ / ç¼–è¾‘ / åˆ é™¤
- **è®¢å•**
  - åˆ›å»ºè®¢å•
  - è®¢å•ç¡®è®¤é¡µã€è®¢å•åˆ—è¡¨ã€è®¢å•è¯¦æƒ…
  - æ”¯ä»˜ï¼ˆMock è¿”å›â€œæš‚ä¸å¯ç”¨/æ¨¡æ‹Ÿâ€ï¼‰

---

## ğŸ”¥æŠ€æœ¯æ ˆ

- **å‰ç«¯æ¡†æ¶**: Vue 2.6
- **è·¯ç”±**: Vue Router 3ï¼ˆHash è·¯ç”±ï¼‰
- **çŠ¶æ€ç®¡ç†**: Vuex 3
- **UI**: Element UI 2
- **HTTP**: Axiosï¼ˆ`vue-axios` æ³¨å…¥åˆ° `this.axios`ï¼‰
- **æ ·å¼**: Sass/SCSS
- **è½®æ’­**: Swiper 5 / `vue-awesome-swiper`
- **æœ¬åœ° Mock API**: Koa + `@koa/router` + `koa-bodyparser`

---

## ğŸ  ç›®å½•ç»“æ„ï¼ˆæ ¸å¿ƒï¼‰

```text
MIMall/
â”œâ”€â”€ koa-mock/              # æœ¬åœ° Koa Mock API æœåŠ¡ï¼ˆç«¯å£ 3000ï¼‰
â”‚                          # æ³¨æ„ï¼šç”±äºåŸå§‹åç«¯æœåŠ¡ä¸å¯ç”¨ï¼Œæ­¤ç›®å½•æä¾› Mock æ¥å£ç”¨äºå¼€å‘
â”‚   â”œâ”€â”€ app.js             # Koa å¯åŠ¨å…¥å£
â”‚   â”œâ”€â”€ mall.js            # ä¸šåŠ¡æ¥å£ï¼ˆ/api å‰ç¼€ï¼‰
â”‚   â””â”€â”€ data.json          # ç®€æ˜“"ç”¨æˆ·æ•°æ®"æŒä¹…åŒ–ï¼ˆé¦–æ¬¡è¿è¡Œä¼šè‡ªåŠ¨ç”Ÿæˆï¼‰
â”œâ”€â”€ public/                # é™æ€èµ„æºï¼ˆå›¾ç‰‡ã€index.html ç­‰ï¼‰
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main.js            # å…¥å£ï¼šAxios æ‹¦æˆªå™¨/å…¨å±€æ’ä»¶æ³¨å†Œç­‰
â”‚   â”œâ”€â”€ router/router.js   # è·¯ç”±å®šä¹‰
â”‚   â”œâ”€â”€ store/             # Vuexï¼ˆç”¨æˆ·åã€è´­ç‰©è½¦æ•°é‡ï¼‰
â”‚   â”œâ”€â”€ components/        # å…¬å…±ç»„ä»¶ï¼ˆHeader/Footer/Modal/Loading ç­‰ï¼‰
â”‚   â”œâ”€â”€ views/             # é¡µé¢ï¼ˆé¦–é¡µ/è¯¦æƒ…/è´­ç‰©è½¦/è®¢å•/ç™»å½•æ³¨å†Œç­‰ï¼‰
â”‚   â””â”€â”€ storage/           # sessionStorage å°è£…
â”œâ”€â”€ vue.config.js          # å¼€å‘ä»£ç†é…ç½®ï¼ˆ/api -> http://localhost:3000ï¼‰
â””â”€â”€ package.json
```

---

## :bell: ç¯å¢ƒè¦æ±‚

- **Node.js**: å»ºè®® 14+ / 16+ï¼ˆVue CLI 5 å…¼å®¹æ€§æ›´å¥½ï¼‰
- **åŒ…ç®¡ç†å™¨**: npmï¼ˆé¡¹ç›®åŒ…å« `package-lock.json`ï¼Œæ¨èä½¿ç”¨ npmï¼‰
- **ç«¯å£**
  - å‰ç«¯ï¼š`8080`ï¼ˆè§ `vue.config.js`ï¼‰
  - Mock APIï¼š`3000`ï¼ˆè§ `koa-mock/app.js`ï¼‰

---

## :blue_heart: ä¸€é”®è·‘èµ·æ¥ï¼ˆå¼€å‘ç¯å¢ƒï¼‰

### 1) å¯åŠ¨ Mock APIï¼ˆKoaï¼Œç«¯å£ 3000ï¼‰

> **è¯´æ˜**ï¼šç”±äºåŸå§‹åç«¯æœåŠ¡ä¸å¯ç”¨ï¼Œé¡¹ç›®ä½¿ç”¨ `koa-mock/` æä¾›æœ¬åœ° Mock APIã€‚å¦‚æœä½ æœ‰å¯ç”¨çš„åç«¯æœåŠ¡ï¼Œå¯ä»¥è·³è¿‡æ­¤æ­¥éª¤ï¼Œç›´æ¥é…ç½®åç«¯åœ°å€ã€‚

åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œï¼š

```bash
cd koa-mock
npm install
npm run dev
```

çœ‹åˆ°ç±»ä¼¼è¾“å‡ºè¡¨ç¤ºæˆåŠŸï¼š

- `http://localhost:3000/health`
- `http://localhost:3000/api/user/login`

### 2) å¯åŠ¨å‰ç«¯ï¼ˆVueï¼Œç«¯å£ 8080ï¼‰

å¦å¼€ä¸€ä¸ªç»ˆç«¯ï¼Œåœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œï¼š

```bash
npm install
npm run serve
```

æµè§ˆå™¨æ‰“å¼€ `http://localhost:8080`ã€‚

---

## :airplane: é»˜è®¤è´¦å·ï¼ˆMock ç¯å¢ƒï¼‰

`koa-mock` é¦–æ¬¡å¯åŠ¨ä¼šè‡ªåŠ¨ç”Ÿæˆ `koa-mock/data.json`ï¼Œå†…ç½®ä¸€ä¸ªé»˜è®¤ç”¨æˆ·ï¼š

- **ç”¨æˆ·å**: `admin`
- **å¯†ç **: `123456`

ä½ ä¹Ÿå¯ä»¥åœ¨æ³¨å†Œé¡µè‡ªè¡Œæ³¨å†Œï¼Œæ–°ç”¨æˆ·ä¼šå†™å…¥ `koa-mock/data.json`ï¼ˆä»…ç”¨äºæœ¬åœ°å¼€å‘æ¼”ç¤ºï¼‰ã€‚

---

## :collision: è¯·æ±‚ä»£ç†ä¸ç™»å½•æ€è¯´æ˜ï¼ˆéå¸¸é‡è¦ï¼‰

### ä»£ç†è§„åˆ™

å‰ç«¯çš„ Axios é»˜è®¤åŸºåœ°å€é…ç½®ä¸ºï¼š

- `axios.defaults.baseURL = "/api"`ï¼ˆè§ `src/main.js`ï¼‰

å¼€å‘æ—¶ç”± `vue.config.js` å°†è¯·æ±‚ä»£ç†åˆ° Mock æœåŠ¡ï¼š

- `http://localhost:8080/api/**` â†’ `http://localhost:3000/api/**`

å¦å¤–è¿˜æ”¯æŒå°† `/mall/**` é‡å†™åˆ° `/api/**`ï¼ˆæ–¹ä¾¿å…¼å®¹æŸäº›æ—§æ¥å£å‰ç¼€ï¼‰ã€‚

### è¿”å›ç»“æ„ & ç»Ÿä¸€æ‹¦æˆª

é¡¹ç›®é‡Œçº¦å®šåç«¯è¿”å›ç»“æ„å¤§è‡´ä¸ºï¼š

- `status === 0`ï¼šä¸šåŠ¡æˆåŠŸï¼ŒAxios æ‹¦æˆªå™¨ä¼š **ç›´æ¥è¿”å› `data` å­—æ®µ**
- `status === 10`ï¼šæœªç™»å½•ï¼Œè‹¥å½“å‰ä¸åœ¨ `#/index` ä¼šè·³è½¬ `/#/login`
- å…¶ä»–ï¼šå¼¹å‡ºé”™è¯¯æç¤ºå¹¶ reject

ä»¥ä¸Šé€»è¾‘åœ¨ `src/main.js` çš„ `axios.interceptors.response` ä¸­ç»Ÿä¸€å¤„ç†ã€‚

### Cookie ç™»å½•æ€

Mock ç™»å½•æˆåŠŸåä¼šä¸‹å‘ Cookieï¼š

- `mallUserId`
- `mallUserName`

åç»­éœ€è¦ç™»å½•æ€çš„æ¥å£ï¼Œä¼šé€šè¿‡è¯»å– Cookie æ¥æ ¡éªŒæ˜¯å¦ç™»å½•ï¼ˆè§ `koa-mock/app.js` / `koa-mock/mall.js`ï¼‰ã€‚

---

## å¯ç”¨è„šæœ¬

åœ¨é¡¹ç›®æ ¹ç›®å½•ï¼š

```bash
# å¼€å‘å¯åŠ¨ï¼ˆdevelopmentï¼‰
npm run serve

# æµ‹è¯•æ¨¡å¼å¯åŠ¨ï¼ˆtestï¼‰
npm run test

# æ„å»ºç”Ÿäº§åŒ…ï¼ˆproductionï¼‰
npm run build

# eslint
npm run lint
```

åœ¨ `koa-mock/`ï¼š

```bash
# å¯åŠ¨
npm run start

# å¼€å‘çƒ­é‡è½½
npm run dev
```

---

## ğŸš© é¡µé¢è·¯ç”±ï¼ˆéƒ¨åˆ†ï¼‰

è·¯ç”±å®šä¹‰è§ `src/router/router.js`ï¼Œå¸¸è§é¡µé¢ï¼š

- `/#/index`ï¼šé¦–é¡µ
- `/#/product/:id`ï¼šå•†å“å±•ç¤ºï¼ˆåˆ—è¡¨/æ¨èå…¥å£ï¼‰
- `/#/productDetailed/:id`ï¼šå•†å“è¯¦æƒ…
- `/#/cart`ï¼šè´­ç‰©è½¦
- `/#/order/confirm`ï¼šè®¢å•ç¡®è®¤
- `/#/order/list`ï¼šè®¢å•åˆ—è¡¨
- `/#/order/pay`ï¼šè®¢å•æ”¯ä»˜
- `/#/login`ï¼šç™»å½•
- `/#/register`ï¼šæ³¨å†Œ

---

## Mock API ä¸€è§ˆï¼ˆæ ¸å¿ƒï¼‰

> æ¥å£å‰ç¼€ï¼š`/api`

- **ç”¨æˆ·**
  - `POST /api/user/register`
  - `POST /api/user/login`
  - `GET  /api/user`
  - `POST /api/user/logout`
- **å•†å“**
  - `GET /api/products?pageSize=xx`
  - `GET /api/products/:id`
- **è´­ç‰©è½¦**
  - `GET    /api/carts`
  - `POST   /api/carts`
  - `PUT    /api/carts/:id`
  - `DELETE /api/carts/:id`
  - `PUT    /api/carts/selectAll`
  - `PUT    /api/carts/unSelectAll`
  - `GET    /api/carts/products/sum`
- **æ”¶è´§åœ°å€**
  - `GET    /api/shippings`
  - `POST   /api/shippings`
  - `PUT    /api/shippings/:id`
  - `DELETE /api/shippings/:id`
- **è®¢å•**
  - `POST /api/orders`
  - `GET  /api/orders`
  - `GET  /api/orders/:id`
  - `POST /api/pay`ï¼ˆMockï¼šè¿”å›â€œæš‚ä¸å¯ç”¨/æ¨¡æ‹Ÿâ€ï¼‰

---

## ğŸŒ° å¸¸è§é—®é¢˜ï¼ˆFAQï¼‰

### 1) è®¿é—®æ¥å£ 404 / å‰ç«¯æ²¡èµ°åˆ° Mock

- ç¡®è®¤ `koa-mock` æ˜¯å¦å¯åŠ¨ï¼šè®¿é—® `http://localhost:3000/health`
- ç¡®è®¤å‰ç«¯æ˜¯å¦èµ°ä»£ç†ï¼š`vue.config.js` ä¸­ `/api` ä»£ç†ç›®æ ‡æ˜¯ `http://localhost:3000`
- ç¡®è®¤å‰ç«¯è¯·æ±‚æ˜¯å¦ä»¥ `/api` å¼€å¤´ï¼ˆé¡¹ç›®é»˜è®¤å°±æ˜¯ï¼‰

### 2) ç™»å½•åä»æç¤ºæœªç™»å½•ï¼ˆstatus=10ï¼‰

- ç¡®è®¤ç™»å½•æ¥å£è¿”å›æ˜¯å¦æˆåŠŸï¼ˆ`status === 0`ï¼‰
- ç¡®è®¤æµè§ˆå™¨é‡Œæ˜¯å¦æœ‰ `mallUserId` / `mallUserName` Cookie
- è‹¥ä½ æ”¹è¿‡ç«¯å£/åŸŸåï¼Œæ³¨æ„ Cookie ä¸åŒæº/ä»£ç†å…³ç³»å¯èƒ½ä¼šå½±å“ç™»å½•æ€

### 3) ä¿®æ”¹äº† `vue.config.js` ä½†ä¸ç”Ÿæ•ˆ

`vue.config.js` å±äºæ„å»ºé…ç½®æ–‡ä»¶ï¼Œä¿®æ”¹åéœ€è¦**é‡å¯å‰ç«¯å¼€å‘æœåŠ¡å™¨**ã€‚

---

## ğŸ éƒ¨ç½²å»ºè®®ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰

æœ¬é¡¹ç›®æ˜¯å…¸å‹ SPAï¼Œå¯å°† `npm run build` äº§ç‰©ï¼ˆé»˜è®¤ `dist/`ï¼‰éƒ¨ç½²åˆ°ä»»æ„é™æ€èµ„æºæœåŠ¡å™¨ï¼ˆNginx/OSS/CDN ç­‰ï¼‰ã€‚

- **è‹¥ä½ æ¥å…¥çœŸå®åç«¯**ï¼š
  - å»ºè®®å°† `axios.defaults.baseURL` æ”¹ä¸ºä½ çš„åç«¯åŸŸåï¼ˆæˆ–é€šè¿‡ç¯å¢ƒå˜é‡æ³¨å…¥ï¼‰
  - æˆ–åœ¨ Nginx å±‚åš `/api` åå‘ä»£ç†

---

## ğŸ’License

æœ¬ä»“åº“åŒ…å« `LICENSE` [MIT](https://github.com/MK-320/MIMall/blob/main/LICENSE) æ–‡ä»¶ï¼Œä½¿ç”¨å‰è¯·å…ˆé˜…è¯»å¹¶éµå®ˆç›¸åº”è®¸å¯åè®®ã€‚
